import json

import pytest
import responses

from app.get_data import SahibindenClient


class TestSahibindenClient:
    @staticmethod
    def get_ads_url(client: SahibindenClient) -> str:
        return client.host + client.host_ads_suffix

    @staticmethod
    def get_ads_parameters() -> dict:
        return {"address_town": 83}

    @pytest.mark.parametrize("status_code", (201, 302, 403, 404))
    @responses.activate
    def test_get_status_code(self, client, status_code):
        url = client.host
        responses.add(method=responses.GET, url=url, status=status_code)
        current_code = client.get_status_code()
        assert status_code == current_code

    @responses.activate
    def test_get_ads(self, client):
        j = json.loads(
            '{"realEstateProjects":null,"favoriteClassifieds":null,"paging":{"pagingOffset":0,"pagingSize":1000,"totalResults":1},"classifieds":null,"categoryFacets":[],"searchMeta":{"sections":[{"name":"geoLocation","label":"Location","elements":[{"name":"geoLocation","canonicalName":null,"label":"Location","inputType":"GEOLOCATION","multiSelect":false,"defaultValue":{},"enumValues":[],"unitEnumValues":null,"showInSearchPage":true,"elementMeta":null,"selectedUnitLabel":"","hasMore":false,"collapsed":true}]},{"name":"address","label":"Adres","elements":[{"name":"address","canonicalName":null,"label":"Adres","inputType":"ADDRESS","multiSelect":false,"defaultValue":[{"suffix":"town","breadcrumb":[{"id":"83","label":"Muratpaşa"},{"id":"7","label":"Antalya"},{"id":"3","label":"Akdeniz Bölgesi"},{"id":"1","label":"Türkiye"}]},{"suffix":"town","breadcrumb":[{"id":"84","label":"Kepez"},{"id":"7","label":"Antalya"},{"id":"3","label":"Akdeniz Bölgesi"},{"id":"1","label":"Türkiye"}]}],"enumValues":[{"id":"#ANY","label":"All cities","count":null,"facetUrl":"/haritada-emlak-arama/?date=15days&category=16624&price_max=1000","selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":null,"excluded":false,"otherValue":false,"childrenTotalCount":null,"anyValue":true},{"id":"4832","label":"Kızılarık Mh.","count":1,"facetUrl":"/haritada-emlak-arama/?date=15days&category=16624&address_town=83&address_town=84&price_max=1000&address_city=7&address_city=4832","selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":null,"excluded":false,"otherValue":false,"childrenTotalCount":1,"anyValue":false}],"unitEnumValues":null,"showInSearchPage":true,"elementMeta":{"locationFacetLevel":"quarter"},"selectedUnitLabel":"","hasMore":false,"collapsed":true}]},{"name":"price","label":"Price","elements":[{"name":"price","canonicalName":null,"label":"Price","inputType":"RANGE","multiSelect":false,"defaultValue":{"ranges":"#ANY","max":1000.0,"currency":"1","label":"1,000 and below"},"enumValues":[],"unitEnumValues":[{"id":"1","label":"TL","count":null,"facetUrl":"/haritada-emlak-arama/?date=15days&category=16624&address_town=83&address_town=84&price_max=1000&address_city=7","selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":1.0,"excluded":false,"otherValue":false,"childrenTotalCount":null,"anyValue":false},{"id":"2","label":"USD","count":null,"facetUrl":"/haritada-emlak-arama/?date=15days&category=16624&address_town=83&address_town=84&price_max=1000&price_currency=2&address_city=7","selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":19.4155,"excluded":false,"otherValue":false,"childrenTotalCount":null,"anyValue":false},{"id":"3","label":"EUR","count":null,"facetUrl":"/haritada-emlak-arama/?date=15days&category=16624&address_town=83&address_town=84&price_max=1000&price_currency=3&address_city=7","selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":21.2503,"excluded":false,"otherValue":false,"childrenTotalCount":null,"anyValue":false},{"id":"4","label":"GBP","count":null,"facetUrl":"/haritada-emlak-arama/?date=15days&category=16624&address_town=83&address_town=84&price_max=1000&price_currency=4&address_city=7","selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":24.1769,"excluded":false,"otherValue":false,"childrenTotalCount":null,"anyValue":false}],"showInSearchPage":true,"elementMeta":null,"selectedUnitLabel":"TL","hasMore":false,"collapsed":false}]},{"name":"a24","label":"m² (Brüt)","elements":[{"name":"a24","canonicalName":"m2-brut","label":"m² (Brüt)","inputType":"RANGE","multiSelect":false,"defaultValue":{"ranges":"#ANY","label":""},"enumValues":[],"unitEnumValues":null,"showInSearchPage":true,"elementMeta":null,"selectedUnitLabel":"","hasMore":false,"collapsed":false}]},{"name":"a20","label":"Number of Rooms","elements":[{"name":"a20","canonicalName":"number-of-rooms","label":"Number of Rooms","inputType":"LIST","multiSelect":true,"defaultValue":["#ANY"],"enumValues":[{"id":"38473","label":"1+1","count":1,"facetUrl":"/haritada-emlak-arama/?date=15days&category=16624&address_town=83&address_town=84&price_max=1000&a20=38473&address_city=7","selected":false,"defaultName":"1+1","postClassifiedLabel":null,"enumValues":null,"elementMeta":null,"excluded":false,"otherValue":false,"childrenTotalCount":1,"anyValue":false}],"unitEnumValues":null,"showInSearchPage":true,"elementMeta":null,"selectedUnitLabel":"","hasMore":false,"collapsed":false}]},{"name":"a812","label":"Age of Building","elements":[{"name":"a812","canonicalName":"age-of-building","label":"Age of Building","inputType":"LIST","multiSelect":true,"defaultValue":["#ANY"],"enumValues":[{"id":"40606","label":"Between 5-10","count":1,"facetUrl":"/haritada-emlak-arama/?date=15days&a812=40606&category=16624&address_town=83&address_town=84&price_max=1000&address_city=7","selected":false,"defaultName":"5-10 arası","postClassifiedLabel":null,"enumValues":null,"elementMeta":null,"excluded":false,"otherValue":false,"childrenTotalCount":1,"anyValue":false}],"unitEnumValues":null,"showInSearchPage":true,"elementMeta":null,"selectedUnitLabel":"","hasMore":false,"collapsed":true}]},{"name":"a811","label":"Floor Number","elements":[{"name":"a811","canonicalName":"floor-number","label":"Floor Number","inputType":"LIST","multiSelect":true,"defaultValue":["#ANY"],"enumValues":[{"id":"40861","label":"Ground Floor","count":1,"facetUrl":"/haritada-emlak-arama/?date=15days&a811=40861&category=16624&address_town=83&address_town=84&price_max=1000&address_city=7","selected":false,"defaultName":"Giriş Katı","postClassifiedLabel":null,"enumValues":null,"elementMeta":null,"excluded":false,"otherValue":false,"childrenTotalCount":1,"anyValue":false}],"unitEnumValues":null,"showInSearchPage":true,"elementMeta":null,"selectedUnitLabel":"","hasMore":false,"collapsed":true}]},{"name":"a810","label":"Number of Floors","elements":[{"name":"a810","canonicalName":"number-of-floors","label":"Number of Floors","inputType":"LIST","multiSelect":true,"defaultValue":["#ANY"],"enumValues":[{"id":"40586","label":"5","count":1,"facetUrl":"/haritada-emlak-arama/?date=15days&a810=40586&category=16624&address_town=83&address_town=84&price_max=1000&address_city=7","selected":false,"defaultName":"5","postClassifiedLabel":null,"enumValues":null,"elementMeta":null,"excluded":false,"otherValue":false,"childrenTotalCount":1,"anyValue":false}],"unitEnumValues":null,"showInSearchPage":true,"elementMeta":null,"selectedUnitLabel":"","hasMore":false,"collapsed":true}]},{"name":"a23","label":"Heating","elements":[{"name":"a23","canonicalName":"heating","label":"Heating","inputType":"LIST","multiSelect":true,"defaultValue":["#ANY"],"enumValues":[{"id":"38518","label":"Air Conditioning","count":1,"facetUrl":"/haritada-emlak-arama/?date=15days&a23=38518&category=16624&address_town=83&address_town=84&price_max=1000&address_city=7","selected":false,"defaultName":"Klima","postClassifiedLabel":null,"enumValues":null,"elementMeta":null,"excluded":false,"otherValue":false,"childrenTotalCount":1,"anyValue":false}],"unitEnumValues":null,"showInSearchPage":true,"elementMeta":null,"selectedUnitLabel":"","hasMore":false,"collapsed":true}]},{"name":"a22","label":"Number of Bathrooms","elements":[{"name":"a22","canonicalName":"number-of-bathrooms","label":"Number of Bathrooms","inputType":"LIST","multiSelect":true,"defaultValue":["#ANY"],"enumValues":[{"id":"38505","label":"1","count":1,"facetUrl":"/haritada-emlak-arama/?date=15days&a22=38505&category=16624&address_town=83&address_town=84&price_max=1000&address_city=7","selected":false,"defaultName":"1","postClassifiedLabel":null,"enumValues":null,"elementMeta":null,"excluded":false,"otherValue":false,"childrenTotalCount":1,"anyValue":false}],"unitEnumValues":null,"showInSearchPage":true,"elementMeta":null,"selectedUnitLabel":"","hasMore":false,"collapsed":true}]},{"name":"a106960","label":"Balcony","elements":[{"name":"a106960","canonicalName":"balcony","label":"Balcony","inputType":"LIST","multiSelect":true,"defaultValue":["#ANY"],"enumValues":[{"id":"1202732","label":"Available","count":1,"facetUrl":"/haritada-emlak-arama/?date=15days&a106960=1202732&category=16624&address_town=83&address_town=84&price_max=1000&address_city=7","selected":false,"defaultName":"Var","postClassifiedLabel":null,"enumValues":null,"elementMeta":null,"excluded":false,"otherValue":false,"childrenTotalCount":1,"anyValue":false}],"unitEnumValues":null,"showInSearchPage":true,"elementMeta":null,"selectedUnitLabel":"","hasMore":false,"collapsed":true}]},{"name":"a103713","label":"Furnished","elements":[{"name":"a103713","canonicalName":"furnished","label":"Furnished","inputType":"COMBO","multiSelect":false,"defaultValue":"#ANY","enumValues":[{"id":"true","label":"Yes","count":1,"facetUrl":"/haritada-emlak-arama/?date=15days&a103713=true&category=16624&address_town=83&address_town=84&price_max=1000&address_city=7","selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":null,"excluded":false,"otherValue":false,"childrenTotalCount":1,"anyValue":false}],"unitEnumValues":null,"showInSearchPage":true,"elementMeta":null,"selectedUnitLabel":"","hasMore":false,"collapsed":true}]},{"name":"a98426","label":"User Status","elements":[{"name":"a98426","canonicalName":"user-status","label":"User Status","inputType":"LIST","multiSelect":true,"defaultValue":["#ANY"],"enumValues":[{"id":"1119544","label":"Renting","count":1,"facetUrl":"/haritada-emlak-arama/?date=15days&a98426=1119544&category=16624&address_town=83&address_town=84&price_max=1000&address_city=7","selected":false,"defaultName":"Kiracılı","postClassifiedLabel":null,"enumValues":null,"elementMeta":null,"excluded":false,"otherValue":false,"childrenTotalCount":1,"anyValue":false}],"unitEnumValues":null,"showInSearchPage":true,"elementMeta":null,"selectedUnitLabel":"","hasMore":false,"collapsed":true}]},{"name":"a103651","label":"Within a Building Complex","elements":[{"name":"a103651","canonicalName":"within-a-building-complex","label":"Within a Building Complex","inputType":"COMBO","multiSelect":false,"defaultValue":"#ANY","enumValues":[{"id":"1139074","label":"No","count":1,"facetUrl":"/haritada-emlak-arama/?date=15days&a103651=1139074&category=16624&address_town=83&address_town=84&price_max=1000&address_city=7","selected":false,"defaultName":"Hayır","postClassifiedLabel":null,"enumValues":null,"elementMeta":null,"excluded":false,"otherValue":false,"childrenTotalCount":1,"anyValue":false}],"unitEnumValues":null,"showInSearchPage":true,"elementMeta":null,"selectedUnitLabel":"","hasMore":false,"collapsed":true}]},{"name":"a27","label":"From","elements":[{"name":"a27","canonicalName":"from","label":"From","inputType":"COMBO","multiSelect":false,"defaultValue":"#ANY","enumValues":[{"id":"38460","label":"Owner","count":1,"facetUrl":"/haritada-emlak-arama/?date=15days&a27=38460&category=16624&address_town=83&address_town=84&price_max=1000&address_city=7","selected":false,"defaultName":"Sahibinden","postClassifiedLabel":null,"enumValues":null,"elementMeta":null,"excluded":false,"otherValue":false,"childrenTotalCount":1,"anyValue":false}],"unitEnumValues":null,"showInSearchPage":true,"elementMeta":null,"selectedUnitLabel":"","hasMore":false,"collapsed":true}]},{"name":"a111578","label":"Available for Viewing with Video Call","elements":[{"name":"a111578","canonicalName":"available-for-viewing-with-video-call","label":"Available for Viewing with Video Call","inputType":"LIST","multiSelect":true,"defaultValue":["#ANY"],"enumValues":[{"id":"1244987","label":"Hayır","count":1,"facetUrl":"/haritada-emlak-arama/?date=15days&a111578=1244987&category=16624&address_town=83&address_town=84&price_max=1000&address_city=7","selected":false,"defaultName":"Hayır","postClassifiedLabel":null,"enumValues":null,"elementMeta":null,"excluded":false,"otherValue":false,"childrenTotalCount":1,"anyValue":false}],"unitEnumValues":null,"showInSearchPage":true,"elementMeta":null,"selectedUnitLabel":"","hasMore":false,"collapsed":true}]},{"name":"date","label":"Ad Date","elements":[{"name":"date","canonicalName":null,"label":"Ad Date","inputType":"COMBO","multiSelect":false,"defaultValue":"15days","enumValues":[{"id":"3days","label":"Last 3 days","count":1,"facetUrl":"/haritada-emlak-arama/?date=3days&category=16624&address_town=83&address_town=84&price_max=1000&address_city=7","selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":null,"excluded":false,"otherValue":false,"childrenTotalCount":1,"anyValue":false},{"id":"7days","label":"Last 7 days","count":1,"facetUrl":"/haritada-emlak-arama/?date=7days&category=16624&address_town=83&address_town=84&price_max=1000&address_city=7","selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":null,"excluded":false,"otherValue":false,"childrenTotalCount":1,"anyValue":false},{"id":"15days","label":"Last 15 days","count":1,"facetUrl":"/haritada-emlak-arama/?category=16624&address_town=83&address_town=84&price_max=1000&address_city=7","selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":null,"excluded":false,"otherValue":false,"childrenTotalCount":1,"anyValue":false},{"id":"30days","label":"Last 30 days","count":1,"facetUrl":"/haritada-emlak-arama/?date=30days&category=16624&address_town=83&address_town=84&price_max=1000&address_city=7","selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":null,"excluded":false,"otherValue":false,"childrenTotalCount":1,"anyValue":false}],"unitEnumValues":null,"showInSearchPage":true,"elementMeta":null,"selectedUnitLabel":"","hasMore":false,"collapsed":false}]},{"name":"query","label":"Keyword or Ad Number","elements":[{"name":"query","canonicalName":null,"label":"Keyword or Ad Number","inputType":"QUERY_TEXT","multiSelect":false,"defaultValue":{"type":"allWords","desc":false},"enumValues":[{"id":"allWords","label":"All words","count":null,"facetUrl":null,"selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":null,"excluded":false,"otherValue":false,"childrenTotalCount":null,"anyValue":false},{"id":"anyWord","label":"Any of these words","count":null,"facetUrl":null,"selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":null,"excluded":false,"otherValue":false,"childrenTotalCount":null,"anyValue":false}],"unitEnumValues":null,"showInSearchPage":true,"elementMeta":null,"selectedUnitLabel":"","hasMore":false,"collapsed":true}]}],"canonicalUrl":"/en/for-rent-flat?date=15days&address_town=83&address_town=84&price_max=1000&address_city=7","title":"Prices of Apartments, Houses and Real Estate are on sahibinden.com","h1":"Apartment for Rent"},"warnings":null,"mapData":null,"formData":{"date":["15days"],"address_country":["1"],"m:includeProjectSummaryFields":["true"],"language":["en"],"category":["16624"],"address_town":["83","84"],"price_currency":["1"],"price_max":["1000"],"address_city":["7"]},"topListSeparatorIndex":0,"breadcrumb":[{"id":"3518","label":"Real Estate","levelName":null},{"id":"3613","label":"Residential","levelName":null},{"id":"16622","label":"For Rent","levelName":null},{"id":"16624","label":"Flat","levelName":null}],"favoriteSearchLink":"date=15days&category=16624&address_town=83&address_town=84&price_max=1000&address_city=7","dmpData":null,"selectedFilters":[{"section":{"name":"price","label":"Price","elements":[{"name":"price","canonicalName":null,"label":"Price","inputType":"RANGE","multiSelect":false,"defaultValue":{"ranges":"#ANY","max":1000.0,"currency":"1","label":"1,000 and below"},"enumValues":[],"unitEnumValues":[{"id":"1","label":"TL","count":null,"facetUrl":"/haritada-emlak-arama/?date=15days&category=16624&address_town=83&address_town=84&price_max=1000&address_city=7","selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":1.0,"excluded":false,"otherValue":false,"childrenTotalCount":null,"anyValue":false},{"id":"2","label":"USD","count":null,"facetUrl":"/haritada-emlak-arama/?date=15days&category=16624&address_town=83&address_town=84&price_max=1000&price_currency=2&address_city=7","selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":19.4155,"excluded":false,"otherValue":false,"childrenTotalCount":null,"anyValue":false},{"id":"3","label":"EUR","count":null,"facetUrl":"/haritada-emlak-arama/?date=15days&category=16624&address_town=83&address_town=84&price_max=1000&price_currency=3&address_city=7","selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":21.2503,"excluded":false,"otherValue":false,"childrenTotalCount":null,"anyValue":false},{"id":"4","label":"GBP","count":null,"facetUrl":"/haritada-emlak-arama/?date=15days&category=16624&address_town=83&address_town=84&price_max=1000&price_currency=4&address_city=7","selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":24.1769,"excluded":false,"otherValue":false,"childrenTotalCount":null,"anyValue":false}],"showInSearchPage":true,"elementMeta":null,"selectedUnitLabel":"TL","hasMore":false,"collapsed":false}]},"label":"Price (TL)","filters":[{"element":{"name":"price","canonicalName":null,"label":"Price","inputType":"RANGE","multiSelect":false,"defaultValue":{"ranges":"#ANY","max":1000.0,"currency":"1","label":"1,000 and below"},"enumValues":[],"unitEnumValues":[{"id":"1","label":"TL","count":null,"facetUrl":"/haritada-emlak-arama/?date=15days&category=16624&address_town=83&address_town=84&price_max=1000&address_city=7","selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":1.0,"excluded":false,"otherValue":false,"childrenTotalCount":null,"anyValue":false},{"id":"2","label":"USD","count":null,"facetUrl":"/haritada-emlak-arama/?date=15days&category=16624&address_town=83&address_town=84&price_max=1000&price_currency=2&address_city=7","selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":19.4155,"excluded":false,"otherValue":false,"childrenTotalCount":null,"anyValue":false},{"id":"3","label":"EUR","count":null,"facetUrl":"/haritada-emlak-arama/?date=15days&category=16624&address_town=83&address_town=84&price_max=1000&price_currency=3&address_city=7","selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":21.2503,"excluded":false,"otherValue":false,"childrenTotalCount":null,"anyValue":false},{"id":"4","label":"GBP","count":null,"facetUrl":"/haritada-emlak-arama/?date=15days&category=16624&address_town=83&address_town=84&price_max=1000&price_currency=4&address_city=7","selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":24.1769,"excluded":false,"otherValue":false,"childrenTotalCount":null,"anyValue":false}],"showInSearchPage":true,"elementMeta":null,"selectedUnitLabel":"TL","hasMore":false,"collapsed":false},"value":"-1000.0","label":"1,000 and below","removeUrl":"/haritada-emlak-arama/?date=15days&category=16624&address_town=83&address_town=84&address_city=7","excluded":false}],"priority":0,"queryText":false,"address":false},{"section":{"name":"date","label":"Ad Date","elements":[{"name":"date","canonicalName":null,"label":"Ad Date","inputType":"COMBO","multiSelect":false,"defaultValue":"15days","enumValues":[{"id":"3days","label":"Last 3 days","count":1,"facetUrl":"/haritada-emlak-arama/?date=3days&category=16624&address_town=83&address_town=84&price_max=1000&address_city=7","selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":null,"excluded":false,"otherValue":false,"childrenTotalCount":1,"anyValue":false},{"id":"7days","label":"Last 7 days","count":1,"facetUrl":"/haritada-emlak-arama/?date=7days&category=16624&address_town=83&address_town=84&price_max=1000&address_city=7","selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":null,"excluded":false,"otherValue":false,"childrenTotalCount":1,"anyValue":false},{"id":"15days","label":"Last 15 days","count":1,"facetUrl":"/haritada-emlak-arama/?category=16624&address_town=83&address_town=84&price_max=1000&address_city=7","selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":null,"excluded":false,"otherValue":false,"childrenTotalCount":1,"anyValue":false},{"id":"30days","label":"Last 30 days","count":1,"facetUrl":"/haritada-emlak-arama/?date=30days&category=16624&address_town=83&address_town=84&price_max=1000&address_city=7","selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":null,"excluded":false,"otherValue":false,"childrenTotalCount":1,"anyValue":false}],"unitEnumValues":null,"showInSearchPage":true,"elementMeta":null,"selectedUnitLabel":"","hasMore":false,"collapsed":false}]},"label":"Ad Date","filters":[{"element":{"name":"date","canonicalName":null,"label":"Ad Date","inputType":"COMBO","multiSelect":false,"defaultValue":"15days","enumValues":[{"id":"3days","label":"Last 3 days","count":1,"facetUrl":"/haritada-emlak-arama/?date=3days&category=16624&address_town=83&address_town=84&price_max=1000&address_city=7","selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":null,"excluded":false,"otherValue":false,"childrenTotalCount":1,"anyValue":false},{"id":"7days","label":"Last 7 days","count":1,"facetUrl":"/haritada-emlak-arama/?date=7days&category=16624&address_town=83&address_town=84&price_max=1000&address_city=7","selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":null,"excluded":false,"otherValue":false,"childrenTotalCount":1,"anyValue":false},{"id":"15days","label":"Last 15 days","count":1,"facetUrl":"/haritada-emlak-arama/?category=16624&address_town=83&address_town=84&price_max=1000&address_city=7","selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":null,"excluded":false,"otherValue":false,"childrenTotalCount":1,"anyValue":false},{"id":"30days","label":"Last 30 days","count":1,"facetUrl":"/haritada-emlak-arama/?date=30days&category=16624&address_town=83&address_town=84&price_max=1000&address_city=7","selected":false,"defaultName":null,"postClassifiedLabel":null,"enumValues":null,"elementMeta":null,"excluded":false,"otherValue":false,"childrenTotalCount":1,"anyValue":false}],"unitEnumValues":null,"showInSearchPage":true,"elementMeta":null,"selectedUnitLabel":"","hasMore":false,"collapsed":false},"value":"15days","label":"Last 15 days","removeUrl":"/haritada-emlak-arama/?category=16624&address_town=83&address_town=84&price_max=1000&address_city=7","excluded":false}],"priority":0,"queryText":false,"address":false}],"clearSearchFiltersUrl":null,"switchToListUrl":null,"selectedPOIs":null,"standartSearchLink":"/arama/ara?date=15days&pagingOffset=0&address_country=1&m%3AincludeProjectSummaryFields=true&language=en&category=16624&address_town=83&address_town=84&price_currency=1&price_max=1000&address_city=7","classifiedMarkers":[{"projectSummary":null,"priceRange":null,"shortName":"emlak-konut-kiralik-bayan-ev-arkadasi-1094566084","formattedPrice":"1.000","id":"1094566084","lat":36.907013,"lon":30.719578,"price":1000.0,"title":"Bayan ev arkadaşı","activePromotions":[],"thumbnailUrl":"https://i0.shbdn.com/photos/56/60/84/x5_1094566084btp.jpg","attributes":{"m² (Brüt)":"80","Number of Rooms":"1+1","Bulunduğu Kat":"Ground Floor"},"storeBadgeUrl":null,"location":"Kızılarık Mh.","projectId":null,"url":"/ilan/emlak-konut-kiralik-bayan-ev-arkadasi-1094566084/detay","hasTopListPromotion":false}]}'
        )
        url = self.get_ads_url(client)
        transmitted_params = self.get_ads_parameters()
        responses.add(method=responses.GET, url=url, status=200, json=j)
        client.get_ads(transmitted_params)

    @responses.activate
    def test_get_ads_wrong_schema(self, client):
        data = {}
        url = self.get_ads_url(client)
        transmitted_params = self.get_ads_parameters()
        responses.add(method=responses.GET, url=url, status=200, json=data)
        with pytest.raises(KeyError):
            client.get_ads(transmitted_params)

    @pytest.mark.parametrize("status_code", (201, 302, 403, 404))
    @responses.activate
    def test_get_ads_error_codes(self, client, status_code):
        url = self.get_ads_url(client)
        transmitted_params = self.get_ads_parameters()
        responses.add(method=responses.GET, url=url, status=status_code)
        ads = client.get_ads(transmitted_params)
        assert ads == []
